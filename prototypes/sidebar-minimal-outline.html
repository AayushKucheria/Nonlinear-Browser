<!DOCTYPE html>
<!--
  PROTOTYPE 1: Minimal Outline

  Design direction: Clean, text-first, editor-inspired sidebar.
  The tab tree is a plain indented list — no favicons, no decorations.

  Key choices:
  - Monochrome palette with one blue accent for the active tab
  - 16px indent per nesting level
  - Hover reveals × close button (right-aligned)
  - Triangles toggle collapse/expand for parent tabs
  - Closed tabs shown greyed + strikethrough; can still be re-opened
  - Window sections separated by a subtle divider + label
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sidebar — Minimal Outline</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      font-size: 13px;
      background: #ffffff;
      color: #111;
      width: 300px;
      min-height: 600px;
      display: flex;
      flex-direction: column;
    }

    /* ── Header ── */
    .header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 11px 12px 10px;
      border-bottom: 1px solid #e8e8e8;
      background: #fafafa;
      flex-shrink: 0;
    }
    .header-title {
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.07em;
      text-transform: uppercase;
      color: #555;
      flex: 1;
    }
    .header-count {
      font-size: 11px;
      color: #999;
    }
    .header-btn {
      width: 22px; height: 22px;
      display: flex; align-items: center; justify-content: center;
      border: none; background: none; cursor: pointer;
      border-radius: 4px; color: #aaa; font-size: 14px;
    }
    .header-btn:hover { background: #f0f0f0; color: #555; }

    /* ── Scroll area ── */
    .tree {
      flex: 1;
      overflow-y: auto;
      padding: 4px 0 12px;
    }

    /* ── Window label ── */
    .window-label {
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #bbb;
      padding: 10px 12px 3px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .window-label::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #ebebeb;
    }

    /* ── Tab row ── */
    .tab-row {
      display: flex;
      align-items: center;
      padding: 0 6px 0 0;
      margin: 0 4px;
      border-radius: 5px;
      cursor: pointer;
      min-height: 28px;
      position: relative;
    }
    .tab-row:hover { background: #f4f4f4; }
    .tab-row.is-active { background: #eff6ff; }
    .tab-row.is-active .tab-title { color: #2563eb; font-weight: 500; }
    .tab-row.is-closed .tab-title { color: #ccc; text-decoration: line-through; }
    .tab-row.is-closed .toggle { opacity: 0.3; }

    /* indent spacer */
    .tab-row .indent { flex-shrink: 0; }

    /* collapse toggle */
    .toggle {
      width: 16px; height: 28px;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
      font-size: 9px;
      color: #bbb;
      transition: transform 0.15s;
      user-select: none;
    }
    .toggle.has-children { color: #888; }
    .toggle.has-children:hover { color: #333; }
    .toggle.collapsed { transform: rotate(-90deg); }

    /* title */
    .tab-title {
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 1.3;
      padding: 5px 2px 5px 0;
    }

    /* close button */
    .tab-close {
      opacity: 0;
      flex-shrink: 0;
      width: 18px; height: 18px;
      display: flex; align-items: center; justify-content: center;
      border-radius: 3px;
      font-size: 11px;
      color: #aaa;
      transition: opacity 0.1s;
      margin-left: 2px;
    }
    .tab-row:hover .tab-close { opacity: 1; }
    .tab-close:hover { background: #fee2e2; color: #dc2626; }

    /* status dot */
    .status-dot {
      width: 5px; height: 5px;
      border-radius: 50%;
      flex-shrink: 0;
      margin: 0 5px 0 2px;
    }
    .is-active .status-dot { background: #2563eb; }
    .tab-row:not(.is-active) .status-dot { background: transparent; }

    /* ── Footer ── */
    .footer {
      border-top: 1px solid #e8e8e8;
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      flex-shrink: 0;
      background: #fafafa;
    }
    .footer-btn {
      font-size: 12px;
      color: #888;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      border: none;
      background: none;
    }
    .footer-btn:hover { background: #f0f0f0; color: #333; }
  </style>
</head>
<body>

<div class="header">
  <span class="header-title">Tabs</span>
  <span class="header-count" id="count"></span>
  <button class="header-btn" title="New tab">+</button>
</div>

<div class="tree" id="tree"></div>

<div class="footer">
  <button class="footer-btn" onclick="toggleClosed()">
    <span id="closed-toggle-label">Show closed</span>
  </button>
  <span style="flex:1"></span>
  <button class="footer-btn">Save tree</button>
</div>

<script>
const windows = [
  {
    id: 'w1',
    label: 'Window 1',
    tabs: [
      { id: 1, title: 'Google', active: true, closed: false, children: [
        { id: 2, title: 'Gmail — Inbox (3)', active: false, closed: false, children: [] },
        { id: 3, title: 'Google Docs — Q4 Planning', active: false, closed: false, children: [
          { id: 4, title: 'Google Drive — Shared', active: false, closed: false, children: [] },
          { id: 5, title: 'Google Slides — Deck', active: false, closed: true, children: [] },
        ]},
      ]},
      { id: 6, title: 'GitHub', active: false, closed: false, children: [
        { id: 7, title: 'anthropics / claude-code', active: false, closed: false, children: [
          { id: 8, title: 'Issues · anthropics/claude-code', active: false, closed: false, children: [] },
          { id: 9, title: 'PR #412 — Fix context window…', active: false, closed: true, children: [] },
        ]},
      ]},
      { id: 10, title: 'YouTube', active: false, closed: false, children: [] },
    ]
  },
  {
    id: 'w2',
    label: 'Window 2',
    tabs: [
      { id: 11, title: 'Hacker News', active: false, closed: false, children: [
        { id: 12, title: 'Ask HN: Best way to learn…', active: false, closed: false, children: [] },
        { id: 13, title: 'Show HN: I built a tab manager', active: false, closed: false, children: [] },
      ]},
      { id: 14, title: 'Linear — My Issues', active: false, closed: false, children: [] },
    ]
  }
];

const collapsed = new Set();
let showClosed = false;

function countOpen(tabs) {
  let n = 0;
  for (const t of tabs) {
    if (!t.closed) n++;
    n += countOpen(t.children);
  }
  return n;
}

function allTabs(wins) {
  const result = [];
  for (const w of wins) result.push(...w.tabs);
  return result;
}

function toggleClosed() {
  showClosed = !showClosed;
  document.getElementById('closed-toggle-label').textContent =
    showClosed ? 'Hide closed' : 'Show closed';
  render();
}

function setActive(id) {
  function deactivate(tabs) {
    for (const t of tabs) { t.active = false; deactivate(t.children); }
  }
  function activate(tabs) {
    for (const t of tabs) {
      if (t.id === id) { t.active = true; return true; }
      if (activate(t.children)) return true;
    }
    return false;
  }
  for (const w of windows) deactivate(w.tabs);
  for (const w of windows) if (activate(w.tabs)) break;
  render();
}

function toggleClosed_(id) {
  function toggle(tabs) {
    for (const t of tabs) {
      if (t.id === id) { t.closed = !t.closed; return true; }
      if (toggle(t.children)) return true;
    }
    return false;
  }
  for (const w of windows) toggle(w.tabs);
  render();
}

function renderNode(tab, depth, container) {
  if (tab.closed && !showClosed) {
    // still render children if any visible
    if (!collapsed.has(tab.id)) {
      for (const child of tab.children) renderNode(child, depth, container);
    }
    return;
  }

  const row = document.createElement('div');
  row.className = 'tab-row' +
    (tab.active ? ' is-active' : '') +
    (tab.closed ? ' is-closed' : '');

  // indent
  if (depth > 0) {
    const sp = document.createElement('span');
    sp.className = 'indent';
    sp.style.width = (depth * 16) + 'px';
    row.appendChild(sp);
  }

  // toggle
  const tog = document.createElement('span');
  tog.className = 'toggle' + (tab.children.length ? ' has-children' : '') +
    (collapsed.has(tab.id) ? ' collapsed' : '');
  tog.textContent = tab.children.length ? '▾' : '·';
  if (tab.children.length) {
    tog.onclick = (e) => {
      e.stopPropagation();
      if (collapsed.has(tab.id)) collapsed.delete(tab.id);
      else collapsed.add(tab.id);
      render();
    };
  }
  row.appendChild(tog);

  // active dot
  const dot = document.createElement('span');
  dot.className = 'status-dot';
  row.appendChild(dot);

  // title
  const title = document.createElement('span');
  title.className = 'tab-title';
  title.textContent = tab.title;
  row.appendChild(title);

  // close btn
  const close = document.createElement('span');
  close.className = 'tab-close';
  close.textContent = '✕';
  close.title = tab.closed ? 'Reopen tab' : 'Close tab';
  close.onclick = (e) => { e.stopPropagation(); toggleClosed_(tab.id); };
  row.appendChild(close);

  if (!tab.closed) {
    row.onclick = () => setActive(tab.id);
  }

  container.appendChild(row);

  // children
  if (!collapsed.has(tab.id)) {
    for (const child of tab.children) {
      renderNode(child, depth + 1, container);
    }
  }
}

function render() {
  const tree = document.getElementById('tree');
  tree.innerHTML = '';

  let total = 0;
  for (const w of windows) total += countOpen(w.tabs);
  document.getElementById('count').textContent = total + ' open';

  for (let i = 0; i < windows.length; i++) {
    const w = windows[i];

    if (windows.length > 1) {
      const label = document.createElement('div');
      label.className = 'window-label';
      label.textContent = w.label;
      tree.appendChild(label);
    }

    for (const tab of w.tabs) {
      renderNode(tab, 0, tree);
    }
  }
}

render();
</script>
</body>
</html>
